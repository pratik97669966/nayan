<!DOCTYPE html>
<html lang="hi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JAS Mitra</title>

    <!-- Favicon -->
    <link id="favicon" rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- Google Fonts - Noto Sans (Hindi + Latin) -->
    <link rel="preconnect" href="https.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" rel="stylesheet">

    <!-- jsPDF & html2canvas for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- ===== 1. FIREBASE SDKs (Storage REMOVED) ===== -->
    <script type="module">
        // Firebase SDKs ‡§∏‡•á ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§Ü‡§Ø‡§æ‡§§ ‡§ï‡§∞‡•á‡§Ç
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getDatabase, ref, set, onValue, push, update, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";
        // Firebase Storage SDKs ‡§π‡§ü‡§æ ‡§¶‡§ø‡§è ‡§ó‡§è

        // -----------------------------------------------------------------
        // TODO: ‡§á‡§∏‡•á ‡§Ö‡§™‡§®‡•á Firebase ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§∏‡•á ‡§¨‡§¶‡§≤‡•á‡§Ç
        // -----------------------------------------------------------------
        const firebaseConfig = {
            apiKey: "AIzaSyDgytGr6HPXqMzPepx1JPOvvg1zMc3QrZ8",
            authDomain: "jas-mitra.firebaseapp.com",
            databaseURL: "https://jas-mitra-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "jas-mitra",
            storageBucket: "jas-mitra.firebasestorage.app",
            messagingSenderId: "618945780065",
            appId: "1:618945780065:web:0f98b3e5953ef0ae394d20",
            measurementId: "G-PQQ79SFBP5"
        };
        // -----------------------------------------------------------------

        // Firebase ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡•á‡§Ç
        try {
            const appFirebase = initializeApp(firebaseConfig);
            const auth = getAuth(appFirebase);
            const db = getDatabase(appFirebase);
            // const storage = getStorage(appFirebase); // Storage ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ

            // ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ê‡§™ ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è Firebase ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§µ‡§ø‡§Ç‡§°‡•ã ‡§™‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§ï‡§∞‡§æ‡§è‡§Å
            window.firebaseServices = {
                auth,
                db,
                // storage, // Storage ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ
                ref,
                set,
                onValue,
                push,
                update,
                // storageRef, // Storage ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ
                // uploadString, // Storage ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ
                // getDownloadURL, // Storage ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ
                signInAnonymously,
                onAuthStateChanged,
                serverTimestamp
            };

            // ‡§ê‡§™ ‡§ï‡•á ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§π‡•ã‡§®‡•á ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§¶‡•á‡§Ç
            document.dispatchEvent(new Event('firebaseReady'));

        } catch (e) {
            console.error("Firebase ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:", e);
            alert("Firebase ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡•Ä `firebaseConfig` ‡§ú‡§æ‡§Å‡§ö‡•á‡§Ç‡•§");
        }
    </script>


    <style>
        /* --- 1. ‡§Æ‡§ü‡•á‡§∞‡§ø‡§Ø‡§≤ 3 ‡§ï‡§≤‡§∞ ‡§™‡•à‡§≤‡•á‡§ü ‡§î‡§∞ ‡§¨‡•á‡§∏ --- */
        :root {
            /* ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§•‡•Ä‡§Æ ‡§∞‡§Ç‡§ó (Teal) */
            --primary: #2A9D8F;
            --on-primary: #FFFFFF;
            --primary-container: #B4F3E6;
            --on-primary-container: #00201B;

            /* ‡§è‡§ï‡•ç‡§∏‡•á‡§Ç‡§ü ‡§∞‡§Ç‡§ó (Yellow) */
            --secondary: #E9C46A;
            --on-secondary: #FFFFFF;
            --secondary-container: #FDF3D1;
            --on-secondary-container: #261A00;

            /* ‡§®‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∞‡§≤ ‡§∞‡§Ç‡§ó (Background, Cards, Text) */
            --background: #F4F7F6;
            --on-background: #1A1C1B;
            --surface: #FEFDFB;
            --on-surface: #1A1C1B;
            --surface-variant: #E0E4E2;
            --on-surface-variant: #404946;

            /* ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ ‡§∞‡§Ç‡§ó */
            --status-pending-bg: #f0ad4e;
            --status-inprogress-bg: #0275d8;
            --status-completed-bg: #5cb85c;

            /* ‡§Ö‡§®‡•ç‡§Ø */
            --outline: #707976;
            --shadow-1: 0 1px 2px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-2: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-3: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);

            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-full: 999px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: var(--background);
            color: var(--on-background);
            line-height: 1.6;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- 2. ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ê‡§™ ‡§≤‡•á‡§Ü‡§â‡§ü --- */
        #app-container {
            max-width: 600px;
            min-height: 100vh;
            margin: 0 auto;
            background-color: var(--surface);
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        /* ‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ì‡§µ‡§∞‡§≤‡•á */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.8);
            z-index: 9998;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-weight: 500;
            transition: opacity 0.3s ease;
        }

        #loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--primary-container);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* --- 3. ‡§π‡•á‡§°‡§∞ (‡§ü‡•â‡§™ ‡§ê‡§™ ‡§¨‡§æ‡§∞) --- */
        header {
            background-color: var(--surface);
            color: var(--primary);
            padding: 8px 10px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--surface-variant);
            display: flex;
            align-items: center;
        }

        header .logo-img {
            height: 42px;
            width: 42px;
            border-radius: var(--radius-sm);
            margin-right: 10px;
            object-fit: cover;
            vertical-align: middle;
        }

        header .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* --- 4. ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§Ç‡§ü‡•á‡§Ç‡§ü (‡§™‡•á‡§ú) --- */
        main {
            flex-grow: 1;
            padding: 20px;
            padding-bottom: 100px;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--on-background);
            margin-bottom: 20px;
        }

        .sub-section-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--on-surface-variant);
            margin-top: 20px;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--surface-variant);
            padding-bottom: 5px;
        }

        /* --- 5. ‡§¨‡•â‡§ü‡§Æ ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® ‡§¨‡§æ‡§∞ --- */
        #bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 600px;
            margin: 0 auto;
            background-color: var(--surface);
            border-top: 1px solid var(--surface-variant);
            display: flex;
            justify-content: space-around;
            padding: 0 8px;
            z-index: 100;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.05);
            height: 80px;
        }

        .nav-btn {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--on-surface-variant);
            flex: 1;
            height: 100%;
            gap: 4px;
            transition: color 0.2s ease-in-out;
        }

        .nav-indicator {
            width: 64px;
            height: 32px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease-in-out;
            background-color: transparent;
        }

        .nav-btn .material-icons,
        .nav-btn .material-icons-outlined {
            font-size: 24px;
            transition: color 0.2s ease-in-out;
        }

        .nav-label {
            font-size: 0.75rem;
            font-weight: 500;
            transition: color 0.2s ease-in-out;
        }

        .nav-btn.active {
            color: var(--on-surface);
        }

        .nav-btn.active .nav-indicator {
            background-color: var(--primary-container);
        }

        .nav-btn.active .material-icons {
            color: var(--on-primary-container);
        }

        /* --- 6. ‡§´‡•ç‡§≤‡•ã‡§ü‡§ø‡§Ç‡§ó ‡§è‡§ï‡•ç‡§∂‡§® ‡§¨‡§ü‡§® (FAB) --- */
        #fab {
            position: fixed;
            bottom: 85px;
            right: 25px;
            width: 56px;
            height: 56px;
            background-color: var(--primary);
            color: var(--on-primary);
            border: none;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-3);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 101;
            transition: all 0.3s ease;
            transform: scale(1);
        }

        #fab:hover {
            background-color: #248a7d;
        }

        #fab.hidden {
            transform: scale(0);
        }

        #fab .material-icons-outlined {
            font-size: 28px;
            transition: transform 0.2s ease-in-out;
        }

        /* --- 7. ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ï‡§Ç‡§™‡•ã‡§®‡•á‡§Ç‡§ü‡•ç‡§∏ --- */
        .card {
            background-color: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-1);
            padding: 16px;
            margin-bottom: 20px;
            border: 1px solid var(--surface-variant);
            position: relative;
        }

        .btn {
            display: block;
            width: 100%;
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-radius: var(--radius-full);
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--on-primary);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: var(--on-secondary-container);
        }

        .btn-icon-round {
            background: none;
            border: none;
            color: var(--on-surface-variant);
            cursor: pointer;
            padding: 4px;
            border-radius: var(--radius-full);
        }

        .btn-icon-round:hover {
            background-color: var(--surface-variant);
        }

        /* --- 8. ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° UI --- */
        #page-home .welcome-card {
            background: var(--primary);
            color: var(--on-primary);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }

        #page-home .welcome-card h2 {
            font-size: 1.5rem;
        }

        #page-home .welcome-card p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .dashboard-slider-container {
            width: 100%;
            height: 200px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            position: relative;
            background: var(--surface-variant);
            box-shadow: var(--shadow-2);
        }

        .slider-item {
            width: 100%;
            height: 100%;
            position: absolute;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-size: cover;
            background-position: center;
        }

        .slider-item.active {
            opacity: 1;
        }

        .dashboard-quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .action-btn {
            background-color: var(--primary-container);
            color: var(--on-primary-container);
            padding: 15px;
            border-radius: var(--radius-md);
            text-align: center;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .action-btn:hover {
            box-shadow: var(--shadow-2);
        }

        .action-btn .material-icons-outlined {
            font-size: 28px;
            display: block;
            margin-bottom: 5px;
        }

        .dashboard-pending-feed .feed-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-bottom: 1px solid var(--surface-variant);
        }

        .dashboard-pending-feed .feed-item:last-child {
            border-bottom: none;
        }

        .feed-item .icon {
            color: var(--status-pending-bg);
        }

        .feed-item .info p {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .feed-item .info span {
            font-size: 0.8rem;
            color: var(--on-surface-variant);
        }

        .credits-card .credits-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .credits-card .profile-image {
            width: 64px;
            height: 64px;
            border-radius: var(--radius-full);
            object-fit: cover;
            border: 2px solid var(--primary-container);
            background-color: var(--surface-variant);
        }

        .credits-card .profile-details h3 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--on-surface);
            margin: 0;
        }

        .credits-card .profile-details p {
            font-size: 0.9rem;
            color: var(--on-surface-variant);
            line-height: 1.4;
            margin: 0;
        }

        .credits-taglines {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--surface-variant);
            text-align: center;
        }

        .credits-taglines .tagline1 {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .credits-taglines .tagline2 {
            font-size: 0.9rem;
            color: var(--on-surface-variant);
            margin-top: 4px;
        }

        /* --- 9. ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§æ‡§∞‡•ç‡§° --- */
        .meeting-card {
            cursor: pointer;
        }

        .meeting-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: var(--radius-md);
            margin-bottom: 12px;
            background-color: #eee;
            border: 1px solid var(--surface-variant);
        }

        .meeting-card h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--on-surface);
        }

        .meeting-card .meta {
            font-size: 0.9rem;
            color: var(--on-surface-variant);
            margin-bottom: 10px;
        }

        .member-card {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .member-card .profile-pic {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-full);
            object-fit: cover;
            background-color: var(--primary-container);
            color: var(--on-primary-container);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .member-card .info h3 {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .member-card .info p {
            font-size: 0.9rem;
            color: var(--on-surface-variant);
        }

        .member-card .actions {
            margin-left: auto;
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .member-card .actions a {
            color: var(--primary);
            font-size: 24px;
            text-decoration: none;
        }

        .decision-card {
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding-right: 40px;
        }

        .decision-card h3 {
            font-size: 1.1rem;
            font-weight: 700;
        }

        .decision-card p {
            font-size: 0.9rem;
            color: var(--on-surface-variant);
        }

        .status-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            padding: 4px 12px;
            border-radius: var(--radius-full);
            font-size: 0.8rem;
            font-weight: 700;
            color: white;
            border: none;
            margin-top: 5px;
            cursor: pointer;
            width: 120px;
        }

        .status-select.status-pending {
            background-color: var(--status-pending-bg);
        }

        .status-select.status-in-progress {
            background-color: var(--status-inprogress-bg);
        }

        .status-select.status-completed {
            background-color: var(--status-completed-bg);
        }

        .btn-edit-decision {
            position: absolute;
            top: 10px;
            right: 10px;
        }


        /* --- 10. ‡§Æ‡•ã‡§°‡§≤ --- */
        #modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 200;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-width: 600px;
            margin: 0 auto;
            background: var(--surface);
            border-radius: 28px 28px 0 0;
            z-index: 201;
            padding: 20px;
            padding-top: 10px;
            display: none;
            transform: translateY(100%);
            transition: transform 0.3s ease-out;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-container.visible,
        #modal-backdrop.visible {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        .modal-header h2 {
            font-size: 1.4rem;
            color: var(--on-surface);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            color: var(--on-surface-variant);
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--on-surface-variant);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--outline);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-family: 'Noto Sans', sans-serif;
            background: var(--surface);
        }

        .form-group input[type="file"] {
            border: 1px dashed var(--primary);
            padding: 10px;
            background: var(--primary-container);
            color: var(--on-primary-container);
        }

        .preview-image {
            width: 100%;
            max-width: 200px;
            margin-top: 10px;
            border-radius: var(--radius-md);
            border: 1px solid var(--outline);
            display: none;
        }

        /* --- 11. ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Æ‡•ã‡§°‡§≤ --- */
        .modal-body {
            padding-bottom: 20px;
        }

        .detail-item {
            margin-bottom: 15px;
        }

        .detail-item label {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--on-surface-variant);
            display: block;
        }

        .detail-item p {
            font-size: 1rem;
            color: var(--on-surface);
            white-space: pre-wrap;
            /* ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•ã ‡§∞‡•à‡§™ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è */
            word-wrap: break-word;
            /* ‡§≤‡§Ç‡§¨‡•á ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•ã ‡§§‡•ã‡§°‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è */
        }

        .photo-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .photo-gallery img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: var(--radius-md);
            border: 1px solid var(--surface-variant);
            cursor: pointer;
        }

        .add-photo-form {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--surface-variant);
        }

        .add-photo-form .form-group {
            margin-bottom: 10px;
        }

        /* --- 12. ‡§ü‡•ã‡§∏‡•ç‡§ü (‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§®) --- */
        #toast-container {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 300;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .toast {
            background: #333;
            color: white;
            padding: 10px 20px;
            border-radius: var(--radius-full);
            font-size: 0.9rem;
            box-shadow: var(--shadow-2);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§ü‡•ã‡§∏‡•ç‡§ü */
        .toast.error {
            background-color: #D32F2F;
            /* ‡§≤‡§æ‡§≤ */
        }

        /* --- 13. ‡§´‡•Å‡§≤‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§® ‡§á‡§Æ‡•á‡§ú ‡§µ‡•ç‡§Ø‡•Ç‡§Ö‡§∞ --- */
        .modal-container-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 400;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
            padding: 10px;
        }

        .modal-container-fullscreen.visible {
            opacity: 1;
            visibility: visible;
        }

        .close-fullscreen-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 32px;
            cursor: pointer;
            z-index: 401;
        }

        #fullscreen-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: var(--radius-md);
        }

        /* --- 14. ‡§´‡•Å‡§ü‡§∞ --- */
        footer {
            background-color: var(--surface-variant);
            color: var(--on-surface-variant);
            text-align: center;
            padding: 15px;
            font-size: 0.8rem;
            margin-top: auto;
        }
    </style>
</head>

<body>

    <!-- ===== ‡§ê‡§™ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ===== -->
    <div id="app-container">

        <!-- ===== ‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ì‡§µ‡§∞‡§≤‡•á (‡§®‡§Ø‡§æ) ===== -->
        <div id="loading-overlay">
            <div class="spinner"></div>
            <p>JAS Mitra ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
        </div>

        <!-- ===== ‡§π‡•á‡§°‡§∞ ===== -->
        <header>
            <img src="logo.png" alt="Logo" class="logo-img"
                onerror="this.src='https://placehold.co/40x40/2A9D8F/FFFFFF?text=JAS'; this.onerror=null;">
            <span class="logo">JAS Mitra</span>
        </header>

        <!-- ===== ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§Ç‡§ü‡•á‡§Ç‡§ü ===== -->
        <main>
            <!-- üè† ‡§™‡•É‡§∑‡•ç‡§†: ‡§π‡•ã‡§Æ/‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° -->
            <div id="page-home" class="page active">
                <div class="welcome-card">
                    <h2>JAS Mitra ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à</h2>
                    <p>‡§∏‡•ç‡§µ‡§∏‡•ç‡§• ‡§ó‡§æ‡§Å‡§µ, ‡§∏‡§∂‡§ï‡•ç‡§§ ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø‡•§</p>
                </div>

                <!-- ‡§á‡§Æ‡•á‡§ú ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ -->
                <div class="dashboard-slider-container" id="dashboard-slider">
                    <!-- JS ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§Ü‡§á‡§ü‡§Æ ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á -->
                </div>

                <!-- ‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§á‡§Ø‡§æ‡§Ç -->
                <h3 class="sub-section-title">‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§á‡§Ø‡§æ‡§Ç</h3>
                <div class="dashboard-quick-actions">
                    <button class="action-btn" id="quick-add-meeting">
                        <span class="material-icons-outlined">event_note</span>
                        ‡§®‡§à ‡§¨‡•à‡§†‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                    </button>
                    <button class="action-btn" id="quick-add-member">
                        <span class="material-icons-outlined">person_add</span>
                        ‡§®‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                    </button>
                </div>

                <!-- ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø -->
                <h3 class="sub-section-title">‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø</h3>
                <div class="card dashboard-pending-feed">
                    <div id="dashboard-feed-list">
                        <!-- JS ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§´‡•Ä‡§° ‡§Ü‡§á‡§ü‡§Æ ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á -->
                    </div>
                </div>

                <!-- ‡§ê‡§™ ‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü ‡§ï‡§æ‡§∞‡•ç‡§° -->
                <h3 class="sub-section-title">‡§ê‡§™ ‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü</h3>
                <div class="card credits-card">
                    <div class="credits-profile">
                        <img src="https://placehold.co/64x64/E0E4E2/404946?text=NB" alt="Nayan Bhiogade"
                            class="profile-image"
                            onerror="this.src='https://placehold.co/64x64/E0E4E2/404946?text=NB'; this.onerror=null;">
                        <div class="profile-details">
                            <h3>Nayan Bhiogade</h3>
                            <p>Gandhi fellow<br>(Piramal swasthya)</p>
                        </div>
                    </div>
                    <div class="credits-taglines">
                        <p class="tagline1">#‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø‡§Æ_‡§ß‡§®‡§∏‡§Ç‡§™‡§¶‡§æ</p>
                        <p class="tagline2">Made with ‚ù§Ô∏è by Piramal</p>
                    </div>
                </div>
            </div>

            <!-- üìÖ ‡§™‡•É‡§∑‡•ç‡§†: ‡§¨‡•à‡§†‡§ï‡•á‡§Ç -->
            <div id="page-meetings" class="page">
                <h2 class="section-title">‡§¨‡•à‡§†‡§ï ‡§∏‡•Ç‡§ö‡•Ä</h2>
                <div id="meetings-list">
                    <!-- JS (Firebase) ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§¨‡•à‡§†‡§ï‡•á‡§Ç ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•Ä ‡§ú‡§æ‡§è‡§Ç‡§ó‡•Ä -->
                </div>
            </div>

            <!-- üë• ‡§™‡•É‡§∑‡•ç‡§†: ‡§∏‡§¶‡§∏‡•ç‡§Ø -->
            <div id="page-members" class="page">
                <h2 class="section-title">‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•Ç‡§ö‡•Ä</h2>
                <div id="members-list">
                    <!-- JS (Firebase) ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á -->
                </div>
            </div>

            <!-- üìã ‡§™‡•É‡§∑‡•ç‡§†: ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø -->
            <div id="page-decisions" class="page">
                <h2 class="section-title">‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ ‡§î‡§∞ ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø</h2>
                <div id="decisions-list">
                    <!-- JS (Firebase) ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á -->
                </div>
            </div>
        </main>

        <!-- ===== ‡§´‡•Å‡§ü‡§∞ ‡§ï‡•ç‡§∞‡•á‡§°‡§ø‡§ü ===== -->
        <footer>
            Created by Nayan Bhiogade
        </footer>

        <!-- ===== ‡§¨‡•â‡§ü‡§Æ ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® ===== -->
        <nav id="bottom-nav">
            <button class="nav-btn active" data-page="home">
                <div class="nav-indicator">
                    <span class="material-icons">home</span>
                </div>
                <span class="nav-label">‡§π‡•ã‡§Æ</span>
            </button>
            <button class="nav-btn" data-page="meetings">
                <div class="nav-indicator">
                    <span class="material-icons-outlined">event</span>
                </div>
                <span class="nav-label">‡§¨‡•à‡§†‡§ï‡•á‡§Ç</span>
            </button>
            <button class="nav-btn" data-page="members">
                <div class="nav-indicator">
                    <span class="material-icons-outlined">groups</span>
                </div>
                <span class="nav-label">‡§∏‡§¶‡§∏‡•ç‡§Ø</span>
            </button>
            <button class="nav-btn" data-page="decisions">
                <div class="nav-indicator">
                    <span class="material-icons-outlined">checklist</span>
                </div>
                <span class="nav-label">‡§®‡§ø‡§∞‡•ç‡§£‡§Ø</span>
            </button>
        </nav>

        <!-- ===== ‡§´‡•ç‡§≤‡•ã‡§ü‡§ø‡§Ç‡§ó ‡§è‡§ï‡•ç‡§∂‡§® ‡§¨‡§ü‡§® (FAB) ===== -->
        <button id="fab" class="hidden">
            <span class="material-icons-outlined">add</span>
        </button>

        <!-- ===== ‡§Æ‡•ã‡§°‡§≤ (‡§™‡•â‡§™-‡§Ö‡§™ ‡§´‡•â‡§∞‡•ç‡§Æ) ===== -->
        <div id="modal-backdrop"></div>

        <!-- ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó ‡§Æ‡•ã‡§°‡§≤ -->
        <div id="modal-meeting" class="modal-container">
            <div class="modal-header">
                <h2>‡§®‡§à ‡§¨‡•à‡§†‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h2>
                <button class="close-modal"><span class="material-icons-outlined">close</span></button>
            </div>
            <form id="meeting-form">
                <div class="form-group">
                    <label for="meetingDate">‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï</label>
                    <input type="date" id="meetingDate" required>
                </div>
                <div class="form-group">
                    <label for="meetingAgenda">‡§è‡§ú‡•á‡§Ç‡§°‡§æ</label>
                    <input type="text" id="meetingAgenda" placeholder="‡§¨‡•à‡§†‡§ï ‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§µ‡§ø‡§∑‡§Ø..." required>
                </div>
                <div class="form-group">
                    <label for="meetingDecisions">‡§≤‡§ø‡§è ‡§ó‡§è ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø</label>
                    <textarea id="meetingDecisions" placeholder="‡§ö‡§∞‡•ç‡§ö‡§æ ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§ï‡•ç‡§Ø‡§æ ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§≤‡§ø‡§è ‡§ó‡§è..."></textarea>
                </div>
                <div class="form-group">
                    <label for="meetingPhoto">‡§´‡•ã‡§ü‡•ã (‡§ï‡•à‡§Æ‡§∞‡§æ ‡§∏‡•á)</label>
                    <input type="file" id="meetingPhoto" accept="image/*" capture="camera">
                    <img id="photoPreview" class="preview-image" alt="‡§´‡•ã‡§ü‡•ã ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç">
                </div>
                <button type="submit" class="btn btn-primary">‡§¨‡•à‡§†‡§ï ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
            </form>
        </div>

        <!-- ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§Æ‡•ã‡§°‡§≤ -->
        <div id="modal-member" class="modal-container">
            <div class="modal-header">
                <h2>‡§®‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h2>
                <button class="close-modal"><span class="material-icons-outlined">close</span></button>
            </div>
            <form id="member-form">
                <div class="form-group">
                    <label for="memberName">‡§®‡§æ‡§Æ</label>
                    <input type="text" id="memberName" placeholder="‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ" required>
                </div>
                <div class="form-group">
                    <label for="memberRole">‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ</label>
                    <input type="text" id="memberRole" placeholder="‡§ú‡•à‡§∏‡•á: ‡§Ö‡§ß‡•ç‡§Ø‡§ï‡•ç‡§∑, ‡§∏‡§ö‡§ø‡§µ, ANM" required>
                </div>
                <div class="form-group">
                    <label for="memberPhone">‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞</label>
                    <input type="tel" id="memberPhone" placeholder="9876543210" required>
                </div>
                <div class="form-group">
                    <label for="memberPhoto">‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§´‡•ã‡§ü‡•ã</label>
                    <input type="file" id="memberPhoto" accept="image/*" capture="camera">
                    <img id="memberPhotoPreview" class="preview-image" alt="‡§´‡•ã‡§ü‡•ã ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç">
                </div>
                <button type="submit" class="btn btn-primary">‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
            </form>
        </div>

        <!-- ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§Æ‡•ã‡§°‡§≤ -->
        <div id="modal-decision" class="modal-container">
            <div class="modal-header">
                <h2>‡§®‡§Ø‡§æ ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ/‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h2>
                <button class="close-modal"><span class="material-icons-outlined">close</span></button>
            </div>
            <form id="decision-form">
                <div class="form-group">
                    <label for="decisionTitle">‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï / ‡§µ‡§ø‡§∑‡§Ø</label>
                    <input type="text" id="decisionTitle" placeholder="‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ ‡§ï‡§æ ‡§µ‡§ø‡§∑‡§Ø" required>
                </div>
                <div class="form-group">
                    <label for="decisionResponsible">‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø</label>
                    <input type="text" id="decisionResponsible" placeholder="‡§ú‡•à‡§∏‡•á: ‡§∞‡§Æ‡•á‡§∂ ‡§™‡§æ‡§ü‡§ø‡§≤" required>
                </div>
                <div class="form-group">
                    <label for="decisionStatus">‡§∏‡•ç‡§•‡§ø‡§§‡§ø (Status)</label>
                    <select id="decisionStatus" required>
                        <option value="pending">‡§≤‡§Ç‡§¨‡§ø‡§§ (Pending)</option>
                        <option value="in-progress">‡§ú‡§æ‡§∞‡•Ä ‡§π‡•à (In Progress)</option>
                        <option value="completed">‡§™‡•Ç‡§∞‡•ç‡§£ (Completed)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="decisionDetails">‡§µ‡§ø‡§µ‡§∞‡§£ / ‡§®‡•ã‡§ü‡•ç‡§∏</label>
                    <textarea id="decisionDetails" placeholder="‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>
            </form>
        </div>

        <!-- ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Æ‡•ã‡§°‡§≤ -->
        <div id="modal-meeting-details" class="modal-container">
            <div class="modal-header">
                <h2 id="details-title">‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
                <button class="close-modal"><span class="material-icons-outlined">close</span></button>
            </div>
            <div class="modal-body">
                <div class="detail-item">
                    <label>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï</label>
                    <p id="details-date"></p>
                </div>
                <div class="detail-item">
                    <label>‡§≤‡§ø‡§è ‡§ó‡§è ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø</label>
                    <p id="details-decisions"></p>
                </div>
                <h3 class="sub-section-title">‡§´‡•ã‡§ü‡•ã ‡§ó‡•à‡§≤‡§∞‡•Ä</h3>
                <div class="photo-gallery" id="details-photo-gallery">
                    <!-- JS ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞‡•á‡§Ç ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•Ä ‡§ú‡§æ‡§è‡§Ç‡§ó‡•Ä -->
                </div>

                <!-- Share Button -->
                <button class="btn btn-secondary" id="btn-share-meeting" style="margin-top: 20px; width: 100%;">
                    <span class="material-icons-outlined"
                        style="font-size: 1.2rem; vertical-align: bottom; margin-right: 5px;">share</span>
                    Share / Export
                </button>

                <!-- ‡§î‡§∞ ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç -->
                <form id="add-photo-form" class="add-photo-form">
                    <h3 class="sub-section-title">‡§®‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h3>
                    <div class="form-group">
                        <label for="newMeetingPhoto">‡§ï‡•à‡§Æ‡§∞‡§æ ‡§∏‡•á ‡§®‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞</label>
                        <input type="file" id="newMeetingPhoto" accept="image/*" capture="camera" required>
                        <input type="hidden" id="details-meeting-id">
                    </div>
                    <button type="submit" class="btn btn-primary">‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
                </form>
            </div>
        </div>

        <!-- ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Æ‡•ã‡§°‡§≤ -->
        <div id="modal-decision-details" class="modal-container">
            <div class="modal-header">
                <h2 id="details-decision-title">‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
                <button class="close-modal"><span class="material-icons-outlined">close</span></button>
            </div>
            <div class="modal-body">
                <div class="detail-item">
                    <label>‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞</label>
                    <p id="details-decision-responsible"></p>
                </div>
                <div class="detail-item">
                    <label>‡§µ‡§ø‡§µ‡§∞‡§£ / ‡§®‡•ã‡§ü‡•ç‡§∏</label>
                    <p id="details-decision-details"></p>
                </div>
                <h3 class="sub-section-title">‡§´‡•ã‡§ü‡•ã ‡§ó‡•à‡§≤‡§∞‡•Ä</h3>
                <div class="photo-gallery" id="details-decision-photo-gallery">
                    <!-- JS ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞‡•á‡§Ç ‡§Ø‡§π‡§æ‡§Ç ‡§≠‡§∞‡•Ä ‡§ú‡§æ‡§è‡§Ç‡§ó‡•Ä -->
                </div>

                <!-- Share Button -->
                <button class="btn btn-secondary" id="btn-share-decision" style="margin-top: 20px; width: 100%;">
                    <span class="material-icons-outlined"
                        style="font-size: 1.2rem; vertical-align: bottom; margin-right: 5px;">share</span>
                    Share / Export
                </button>

                <!-- ‡§î‡§∞ ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á‡§Ç -->
                <form id="add-decision-photo-form" class="add-photo-form">
                    <h3 class="sub-section-title">‡§®‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h3>
                    <div class="form-group">
                        <label for="newDecisionPhoto">‡§ï‡•à‡§Æ‡§∞‡§æ ‡§∏‡•á ‡§®‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞</label>
                        <input type="file" id="newDecisionPhoto" accept="image/*" capture="camera" required>
                        <input type="hidden" id="details-decision-id">
                    </div>
                    <button type="submit" class="btn btn-primary">‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</button>
                </form>
            </div>
        </div>

        <!-- ‡§∂‡•á‡§Ø‡§∞ ‡§Æ‡•á‡§®‡•Ç ‡§Æ‡•ã‡§°‡§≤ -->
        <div id="modal-share-menu" class="modal-container">
            <div class="modal-header">
                <h2>Share / Export</h2>
                <button class="close-modal"><span class="material-icons-outlined">close</span></button>
            </div>
            <div class="modal-body" style="display: flex; flex-direction: column; gap: 15px;">
                <p>‡§Ü‡§™ ‡§á‡§∏ ‡§∞‡§ø‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?</p>
                <button class="btn btn-primary" id="btn-share-whatsapp">
                    Share Text to WhatsApp
                </button>
                <button class="btn btn-secondary" id="btn-share-pdf">
                    Download as PDF
                </button>
            </div>
        </div>

        <!-- ‡§ü‡•ã‡§∏‡•ç‡§ü ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ -->
        <div id="toast-container"></div>

        <!-- Lighbox (Fullscreen Image Viewer) -->
        <div id="modal-image-viewer" class="modal-container-fullscreen">
            <button class="close-fullscreen-modal"><span class="material-icons-outlined">close</span></button>
            <img id="fullscreen-image" src="" alt="Fullscreen Image">
        </div>

    </div> <!-- End of app-container -->

    <!-- PDF ‡§∞‡•á‡§Ç‡§°‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§ø‡§°‡§® ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ -->
    <div id="pdf-render-container"
        style="position: absolute; left: -9999px; top: 0; background: white; padding: 20px; width: 595px; font-family: 'Noto Sans', sans-serif; color: #000; line-height: 1.5;">
    </div>


    <!-- ===== 10. ‡§ú‡§æ‡§µ‡§æ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü (‡§ê‡§™ ‡§≤‡•â‡§ú‡§ø‡§ï) - FIREBASE ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ===== -->
    <script>
        // ‡§Ø‡§π ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü 'firebaseReady' ‡§á‡§µ‡•á‡§Ç‡§ü ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§ó‡•Ä
        document.addEventListener('firebaseReady', () => {

            // --- 0. Firebase ‡§∏‡•á ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç ---
            const {
                auth, db, ref, set, onValue, push, update,
                signInAnonymously, onAuthStateChanged, serverTimestamp
            } = window.firebaseServices; // Storage ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ

            // jsPDF ‡§ï‡•ã ‡§µ‡§ø‡§Ç‡§°‡•ã ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§∏‡•á ‡§á‡§Æ‡•ç‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
            const { jsPDF } = window.jspdf;

            // --- 1. ‡§∞‡•Ä‡§Ø‡§≤‡§ü‡§æ‡§á‡§Æ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ (Firebase RTDB) ---
            const dbFirebase = {

                // Firebase Auth ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§∂‡•ç‡§∞‡•ã‡§§‡§æ‡§ì‡§Ç (listeners) ‡§ï‡•ã ‡§Ö‡§ü‡•à‡§ö ‡§ï‡§∞‡•á‡§Ç
                initAuth: () => {
                    onAuthStateChanged(auth, (user) => {
                        if (user) {
                            // ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§π‡•à (‡§ó‡•Å‡§Æ‡§®‡§æ‡§Æ ‡§∞‡•Ç‡§™ ‡§∏‡•á)
                            app.data.userId = user.uid;
                            console.log("Firebase Auth: User signed in anonymously.", user.uid);
                            // ‡§Ö‡§¨ ‡§ú‡§¨ ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡§æ‡§∏ userId ‡§π‡•à, ‡§π‡§Æ ‡§°‡•á‡§ü‡§æ ‡§∂‡•ç‡§∞‡•ã‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Ö‡§ü‡•à‡§ö ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç
                            dbFirebase.attachListeners();
                        } else {
                            // ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§æ‡§á‡§® ‡§Ü‡§â‡§ü ‡§π‡•à, ‡§∏‡§æ‡§á‡§® ‡§á‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç
                            console.log("Firebase Auth: No user found, signing in anonymously...");
                            signInAnonymously(auth).catch((error) => {
                                console.error("Anonymous sign-in failed:", error);
                                app.toast.show('Error: Could not connect to database.', true);
                            });
                        }
                    });
                },

                // ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•Å‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∞‡•Ä‡§Ø‡§≤‡§ü‡§æ‡§á‡§Æ ‡§∂‡•ç‡§∞‡•ã‡§§‡§æ‡§ì‡§Ç (listeners) ‡§ï‡•ã ‡§Ö‡§ü‡•à‡§ö ‡§ï‡§∞‡•á‡§Ç
                attachListeners: () => {
                    const userId = app.data.userId;
                    if (!userId) return;

                    const loadingOverlay = document.getElementById('loading-overlay');

                    // ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§∂‡•ç‡§∞‡•ã‡§§‡§æ
                    const meetingsRef = ref(db, `jasMitraData/meetings`);
                    onValue(meetingsRef, (snapshot) => {
                        const data = snapshot.val();
                        // Firebase RTDB ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•ã ‡§ê‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç
                        const meetingsArray = data ? Object.keys(data).map(key => ({ ...data[key], id: key })).sort((a, b) => b.createdAt - a.createdAt) : [];
                        app.data.meetings = meetingsArray;
                        app.render.meetings(meetingsArray);
                        app.render.dashboard(); // ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° UI ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                        app.render.dashboardSlider(); // ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                        loadingOverlay.classList.add('hidden'); // ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§≤‡•ã‡§°‡§∞ ‡§õ‡§ø‡§™‡§æ‡§è‡§Å
                    }, (error) => {
                        console.error("Firebase Read Error (meetings):", error);
                        app.toast.show("Error loading meetings.", true);
                        loadingOverlay.classList.add('hidden');
                    });

                    // ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∂‡•ç‡§∞‡•ã‡§§‡§æ
                    const membersRef = ref(db, `jasMitraData/members`);
                    onValue(membersRef, (snapshot) => {
                        const data = snapshot.val();
                        const membersArray = data ? Object.keys(data).map(key => ({ ...data[key], id: key })).sort((a, b) => b.createdAt - a.createdAt) : [];
                        app.data.members = membersArray;
                        app.render.members(membersArray);
                    }, (error) => {
                        console.error("Firebase Read Error (members):", error);
                        app.toast.show("Error loading members.", true);
                    });

                    // ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∂‡•ç‡§∞‡•ã‡§§‡§æ
                    const decisionsRef = ref(db, `jasMitraData/decisions`);
                    onValue(decisionsRef, (snapshot) => {
                        const data = snapshot.val();
                        const decisionsArray = data ? Object.keys(data).map(key => ({ ...data[key], id: key })).sort((a, b) => b.createdAt - a.createdAt) : [];
                        app.data.decisions = decisionsArray;
                        app.render.decisions(decisionsArray);
                        app.render.dashboard(); // ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° UI ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                    }, (error) => {
                        console.error("Firebase Read Error (decisions):", error);
                        app.toast.show("Error loading decisions.", true);
                    });
                },

                // --- ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•á ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§Ç‡§∏ ---

                addMeeting: async (meeting) => {
                    const userId = app.data.userId;
                    // Base64 ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•Ä‡§ß‡•á ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§π‡•à

                    meeting.createdAt = serverTimestamp(); // ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§∞ ‡§∏‡§Æ‡§Ø ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç

                    // RTDB ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                    const newMeetingRef = push(ref(db, `jasMitraData/meetings`));
                    // meeting.id = newMeetingRef.key; // ID ‡§ï‡•ã ‡§Ö‡§¨ ‡§∏‡•á‡§µ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ú‡§º‡§∞‡•Ç‡§∞‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, onValue ‡§á‡§∏‡•á ‡§π‡•à‡§Ç‡§°‡§≤ ‡§ï‡§∞‡•á‡§ó‡§æ
                    await set(newMeetingRef, meeting);
                },

                addMember: async (member) => {
                    const userId = app.data.userId;
                    // Base64 ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•Ä‡§ß‡•á ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§π‡•à

                    member.createdAt = serverTimestamp();

                    // RTDB ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                    const newMemberRef = push(ref(db, `jasMitraData/members`));
                    // member.id = newMemberRef.key;
                    await set(newMemberRef, member);
                },

                addDecision: async (decision) => {
                    const userId = app.data.userId;
                    decision.createdAt = serverTimestamp();
                    const newDecisionRef = push(ref(db, `jasMitraData/decisions`));
                    // decision.id = newDecisionRef.key;
                    await set(newDecisionRef, decision);
                },

                updateDecisionStatus: async (id, newStatus) => {
                    const userId = app.data.userId;
                    // ‡§Ø‡§π‡§æ‡§Å 'id' Firebase ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§¶‡•Ä ‡§ó‡§à ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§π‡•à
                    const decisionRef = ref(db, `jasMitraData/decisions/${id}`);
                    await update(decisionRef, { status: newStatus });
                },

                addPhotoToMeeting: async (id, photoData) => {
                    const userId = app.data.userId;
                    // Base64 ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§∏‡•Ä‡§ß‡•á 'photos' ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§Æ‡•á‡§Ç ‡§™‡•Å‡§∂ ‡§ï‡§∞‡•á‡§Ç
                    const photosRef = ref(db, `jasMitraData/meetings/${id}/photos`);
                    const newPhotoRef = push(photosRef); // 'photos' ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§è‡§ï ‡§®‡§à ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§¨‡§®‡§æ‡§è‡§Å
                    await set(newPhotoRef, photoData); // Base64 ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                },

                addPhotoToDecision: async (id, photoData) => {
                    const userId = app.data.userId;
                    const photosRef = ref(db, `jasMitraData/decisions/${id}/photos`);
                    const newPhotoRef = push(photosRef);
                    await set(newPhotoRef, photoData); // Base64 ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                },

                // --- ‡§°‡•á‡§ü‡§æ ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•á ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§Ç‡§∏ (‡§≤‡•ã‡§ï‡§≤ ‡§°‡•á‡§ü‡§æ ‡§∏‡•á) ---

                getMeetingById: (id) => {
                    return app.data.meetings.find(m => m.id === id);
                },

                getDecisionById: (id) => {
                    return app.data.decisions.find(d => d.id === id);
                },

                getPendingDecisions: () => {
                    return app.data.decisions.filter(d => d.status === 'pending').slice(0, 3);
                },

                getRecentPhotos: (limit = 3) => {
                    // RTDB 'photos' ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•ã ‡§ê‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç
                    return app.data.meetings
                        .flatMap(m => (m.photos ? (Array.isArray(m.photos) ? m.photos : Object.values(m.photos)) : []))
                        .slice(0, limit);
                }
            };

            // --- 2. ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ê‡§™ ‡§≤‡•â‡§ú‡§ø‡§ï ---
            const app = {
                currentPage: 'home',
                currentSliderIndex: 0,
                currentShareId: null,
                currentShareType: null,

                // ‡§®‡§Ø‡§æ: ‡§≤‡•ã‡§ï‡§≤ ‡§°‡•á‡§ü‡§æ ‡§ï‡§æ ‡§ï‡•à‡§∂
                data: {
                    userId: null,
                    meetings: [],
                    members: [],
                    decisions: []
                },

                elements: {
                    loadingOverlay: document.getElementById('loading-overlay'),
                    pages: document.querySelectorAll('.page'),
                    navButtons: document.querySelectorAll('.nav-btn'),
                    fab: document.getElementById('fab'),
                    fabIcon: document.querySelector('#fab .material-icons-outlined'),
                    modalBackdrop: document.getElementById('modal-backdrop'),
                    allModals: document.querySelectorAll('.modal-container'),
                    closeModalBtns: document.querySelectorAll('.close-modal'),
                    meetingForm: document.getElementById('meeting-form'),
                    photoPreview: document.getElementById('photoPreview'),
                    memberForm: document.getElementById('member-form'),
                    memberPhotoPreview: document.getElementById('memberPhotoPreview'),
                    decisionForm: document.getElementById('decision-form'),
                    addPhotoForm: document.getElementById('add-photo-form'),
                    addDecisionPhotoForm: document.getElementById('add-decision-photo-form'),
                    meetingsList: document.getElementById('meetings-list'),
                    membersList: document.getElementById('members-list'),
                    decisionsList: document.getElementById('decisions-list'),
                    dashboardSlider: document.getElementById('dashboard-slider'),
                    dashboardFeedList: document.getElementById('dashboard-feed-list'),
                    quickAddMeeting: document.getElementById('quick-add-meeting'),
                    quickAddMember: document.getElementById('quick-add-member'),
                    detailsTitle: document.getElementById('details-title'),
                    detailsDate: document.getElementById('details-date'),
                    detailsDecisions: document.getElementById('details-decisions'),
                    detailsPhotoGallery: document.getElementById('details-photo-gallery'),
                    detailsMeetingId: document.getElementById('details-meeting-id'),
                    detailsDecisionTitle: document.getElementById('details-decision-title'),
                    detailsDecisionResponsible: document.getElementById('details-decision-responsible'),
                    detailsDecisionDetails: document.getElementById('details-decision-details'),
                    detailsDecisionPhotoGallery: document.getElementById('details-decision-photo-gallery'),
                    detailsDecisionId: document.getElementById('details-decision-id'),
                    btnShareMeeting: document.getElementById('btn-share-meeting'),
                    btnShareDecision: document.getElementById('btn-share-decision'),
                    btnShareWhatsapp: document.getElementById('btn-share-whatsapp'),
                    btnSharePdf: document.getElementById('btn-share-pdf'),
                    modalImageViewer: document.getElementById('modal-image-viewer'),
                    fullscreenImage: document.getElementById('fullscreen-image'),
                    closeFullscreenModal: document.querySelector('.close-fullscreen-modal')
                },

                // ‡§ê‡§™ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç
                init: function () {
                    const favicon = document.getElementById('favicon');
                    const testFavicon = new Image();
                    testFavicon.onerror = () => {
                        favicon.href = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ûï</text></svg>';
                    };
                    testFavicon.src = 'favicon.ico';

                    this.addEventListeners();
                    // Firebase Auth ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠ ‡§ï‡§∞‡•á‡§Ç, ‡§ú‡•ã ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§ü‡•ç‡§∞‡§ø‡§ó‡§∞ ‡§ï‡§∞‡•á‡§ó‡§æ
                    dbFirebase.initAuth();
                    this.navigate.showPage('home');
                },

                // ‡§∏‡§≠‡•Ä ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡•ç‡§®‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                addEventListeners: function () {
                    const els = this.elements;

                    els.navButtons.forEach(btn => {
                        btn.addEventListener('click', () => {
                            this.navigate.showPage(btn.dataset.page);
                        });
                    });

                    els.fab.addEventListener('click', () => this.actions.handleFabClick());

                    els.closeModalBtns.forEach(btn => {
                        btn.addEventListener('click', () => this.modal.hide());
                    });
                    els.modalBackdrop.addEventListener('click', () => this.modal.hide());
                    els.modalImageViewer.addEventListener('click', () => this.modal.hide('image-viewer'));

                    els.btnShareMeeting.addEventListener('click', () => {
                        app.currentShareId = els.detailsMeetingId.value;
                        app.currentShareType = 'meeting';
                        this.modal.show('share-menu');
                    });

                    els.btnShareDecision.addEventListener('click', () => {
                        app.currentShareId = els.detailsDecisionId.value;
                        app.currentShareType = 'decision';
                        this.modal.show('share-menu');
                    });

                    els.btnShareWhatsapp.addEventListener('click', () => {
                        this.actions.shareText(app.currentShareId, app.currentShareType);
                        this.modal.hide();
                    });

                    els.btnSharePdf.addEventListener('click', () => {
                        this.actions.generatePdf(app.currentShareId, app.currentShareType);
                        this.modal.hide();
                    });

                    // ‡§´‡•â‡§∞‡•ç‡§Æ ‡§∏‡§¨‡§Æ‡§ø‡§∂‡§® (‡§Ö‡§¨ async)
                    els.meetingForm.addEventListener('submit', (e) => this.actions.submitMeeting(e));
                    els.memberForm.addEventListener('submit', (e) => this.actions.submitMember(e));
                    els.decisionForm.addEventListener('submit', (e) => this.actions.submitDecision(e));
                    els.addPhotoForm.addEventListener('submit', (e) => this.actions.submitAnotherPhoto(e));
                    els.addDecisionPhotoForm.addEventListener('submit', (e) => this.actions.submitAnotherPhotoToDecision(e));

                    // ‡§´‡•ã‡§ü‡•ã ‡§™‡•ç‡§∞‡•Ä‡§µ‡•ç‡§Ø‡•Ç
                    els.meetingForm.meetingPhoto.addEventListener('change', (e) => this.actions.previewPhoto(e, els.photoPreview, e.target));
                    els.memberForm.memberPhoto.addEventListener('change', (e) => this.actions.previewPhoto(e, els.memberPhotoPreview, e.target));

                    // ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§ï‡•ç‡§µ‡§ø‡§ï ‡§¨‡§ü‡§®
                    els.quickAddMeeting.addEventListener('click', () => this.modal.show('meeting'));
                    els.quickAddMember.addEventListener('click', () => this.modal.show('member'));

                    // ‡§°‡§æ‡§Ø‡§®‡§æ‡§Æ‡§ø‡§ï ‡§¨‡§ü‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§µ‡•á‡§Ç‡§ü ‡§°‡•á‡§≤‡§ø‡§ó‡•á‡§∂‡§®
                    document.body.addEventListener('click', (e) => {
                        const meetingCard = e.target.closest('.meeting-card');
                        if (meetingCard && meetingCard.dataset.meetingId) {
                            this.actions.showMeetingDetails(meetingCard.dataset.meetingId);
                        }
                        const decisionEditBtn = e.target.closest('.btn-edit-decision');
                        if (decisionEditBtn && decisionEditBtn.dataset.id) {
                            this.actions.showDecisionDetails(decisionEditBtn.dataset.id);
                        }
                        if (e.target.matches('.photo-gallery img')) {
                            e.stopPropagation();
                            this.actions.showFullscreenImage(e.target.src);
                        }
                    });

                    // ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§µ‡•á‡§Ç‡§ü ‡§°‡•á‡§≤‡§ø‡§ó‡•á‡§∂‡§®
                    els.decisionsList.addEventListener('change', (e) => {
                        if (e.target.classList.contains('status-select')) {
                            const id = e.target.dataset.id;
                            const newStatus = e.target.value;
                            this.actions.updateDecisionStatus(id, newStatus, e.target);
                        }
                    });
                },

                // --- 3. ‡§∞‡•á‡§Ç‡§°‡§∞‡§ø‡§Ç‡§ó ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§Ç‡§∏ (‡§Ö‡§¨ ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Å‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§§‡•á ‡§π‡•à‡§Ç) ---
                render: {
                    dashboard: function () {
                        const feedList = app.elements.dashboardFeedList;
                        const pending = dbFirebase.getPendingDecisions(); // ‡§≤‡•ã‡§ï‡§≤ ‡§°‡•á‡§ü‡§æ ‡§∏‡•á ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
                        feedList.innerHTML = '';
                        if (pending.length === 0) {
                            feedList.innerHTML = '<p style="font-size: 0.9rem; color: var(--on-surface-variant); text-align: center;">‡§ï‡•ã‡§à ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>';
                        } else {
                            pending.forEach(d => {
                                feedList.innerHTML += `
                                    <div class="feed-item">
                                        <span class="material-icons-outlined icon">pending_actions</span>
                                        <div class="info">
                                            <p>${d.title}</p>
                                            <span>‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞: ${d.responsible}</span>
                                        </div>
                                    </div>
                                `;
                            });
                        }
                    },

                    dashboardSlider: function () {
                        const slider = app.elements.dashboardSlider;
                        let photos = dbFirebase.getRecentPhotos(3);

                        if (photos.length === 0) {
                            photos = [
                                'https://i.postimg.cc/tJLxR4GT/Whats-App-Image-2025-11-01-at-18-45-22-460e6b88.jpg'
                            ];
                        }

                        slider.innerHTML = '';
                        photos.forEach((photo, index) => {
                            // Base64 ‡§Ø‡§æ URL ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à
                            slider.innerHTML += `
                                <div class="slider-item ${index === 0 ? 'active' : ''}" 
                                     style="background-image: url('${photo}')">
                                </div>
                            `;
                        });

                        const items = slider.querySelectorAll('.slider-item');
                        if (items.length > 1) {
                            if (app.sliderInterval) clearInterval(app.sliderInterval);
                            app.currentSliderIndex = 0;
                            app.sliderInterval = setInterval(() => {
                                items[app.currentSliderIndex].classList.remove('active');
                                app.currentSliderIndex = (app.currentSliderIndex + 1) % items.length;
                                items[app.currentSliderIndex].classList.add('active');
                            }, 4000);
                        }
                    },

                    meetings: function (meetings) { // ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Å‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§Ç
                        const listEl = app.elements.meetingsList;
                        listEl.innerHTML = '';
                        if (meetings.length === 0) {
                            listEl.innerHTML = '<p>‡§ï‡•ã‡§à ‡§¨‡•à‡§†‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§ (+) ‡§¶‡§¨‡§æ‡§ï‡§∞ ‡§è‡§ï ‡§®‡§à ‡§¨‡•à‡§†‡§ï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>';
                            return;
                        }
                        meetings.forEach(m => {
                            // RTDB 'photos' ‡§ï‡•ã ‡§ê‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç
                            const photosArray = m.photos ? (Array.isArray(m.photos) ? m.photos : Object.values(m.photos)) : [];
                            const photo = photosArray.length > 0 ? photosArray[0] : 'https://placehold.co/600x400/eee/ccc?text=No+Photo';

                            listEl.innerHTML += `
                                <div class="card meeting-card" data-meeting-id="${m.id}">
                                    <img src="${photo}" alt="Meeting Photo">
                                    <h3>${m.agenda}</h3>
                                    <p class="meta">‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï: ${m.date}</p>
                                </div>
                            `;
                        });
                    },

                    members: function (members) { // ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Å‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§Ç
                        const listEl = app.elements.membersList;
                        listEl.innerHTML = '';
                        if (members.length === 0) {
                            listEl.innerHTML = '<p>‡§ï‡•ã‡§à ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ (+) ‡§¶‡§¨‡§æ‡§ï‡§∞ ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>';
                            return;
                        }
                        members.forEach(p => {
                            const photo = p.photo ?
                                `<img src="${p.photo}" alt="${p.name}" class="profile-pic">` :
                                `<div class="profile-pic"><span class="material-icons-outlined">person</span></div>`;

                            listEl.innerHTML += `
                                <div class="card member-card" data-member-id="${p.id}">
                                    ${photo}
                                    <div class="info">
                                        <h3>${p.name}</h3>
                                        <p>${p.role} | ${p.phone}</p>
                                    </div>
                                    <div class="actions">
                                        <a href="tel:${p.phone}"><span class="material-icons-outlined">call</span></a>
                                        <a href="sms:${p.phone}"><span class="material-icons-outlined">message</span></a>
                                    </div>
                                </div>
                            `;
                        });
                    },

                    decisions: function (decisions) { // ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§Ü‡§∞‡•ç‡§ó‡•ç‡§Ø‡•Å‡§Æ‡•á‡§Ç‡§ü ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≤‡•á‡§Ç
                        const listEl = app.elements.decisionsList;
                        listEl.innerHTML = '';
                        if (decisions.length === 0) {
                            listEl.innerHTML = '<p>‡§ï‡•ã‡§à ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ (+) ‡§¶‡§¨‡§æ‡§ï‡§∞ ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>';
                            return;
                        }
                        decisions.forEach(d => {
                            const statusOptions = `
                                <option value="pending" ${d.status === 'pending' ? 'selected' : ''}>‡§≤‡§Ç‡§¨‡§ø‡§§</option>
                                <option value="in-progress" ${d.status === 'in-progress' ? 'selected' : ''}>‡§ú‡§æ‡§∞‡•Ä ‡§π‡•à</option>
                                <option value="completed" ${d.status === 'completed' ? 'selected' : ''}>‡§™‡•Ç‡§∞‡•ç‡§£</option>
                            `;

                            listEl.innerHTML += `
                                <div class="card decision-card">
                                    <button class="btn-icon-round btn-edit-decision" data-id="${d.id}">
                                        <span class="material-icons-outlined">edit</span>
                                    </button>
                                    <h3>${d.title}</h3>
                                    <select class="status-select status-${d.status}" data-id="${d.id}">
                                        ${statusOptions}
                                    </select>
                                    <p><strong>‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞:</strong> ${d.responsible}</p>
                                    <p><strong>‡§®‡•ã‡§ü‡•ç‡§∏:</strong> ${d.details || 'N/A'}</p>
                                </div>
                            `;
                        });
                    },

                    meetingDetails: function (meeting) {
                        const els = app.elements;
                        els.detailsTitle.textContent = meeting.agenda;
                        els.detailsDate.textContent = meeting.date;
                        els.detailsDecisions.textContent = meeting.decisions || 'N/A';
                        els.detailsMeetingId.value = meeting.id;

                        const gallery = els.detailsPhotoGallery;
                        gallery.innerHTML = '';
                        const photosArray = meeting.photos ? (Array.isArray(meeting.photos) ? meeting.photos : Object.values(meeting.photos)) : [];

                        if (photosArray.length > 0) {
                            photosArray.forEach(photo => {
                                gallery.innerHTML += `<img src="${photo}" alt="Meeting Gallery Photo">`;
                            });
                        } else {
                            gallery.innerHTML = '<p>‡§ï‡•ã‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>';
                        }
                    },

                    decisionDetails: function (decision) {
                        const els = app.elements;
                        els.detailsDecisionTitle.textContent = decision.title;
                        els.detailsDecisionResponsible.textContent = decision.responsible;
                        els.detailsDecisionDetails.textContent = decision.details || 'N/A';
                        els.detailsDecisionId.value = decision.id;

                        const gallery = els.detailsDecisionPhotoGallery;
                        gallery.innerHTML = '';
                        const photosArray = decision.photos ? (Array.isArray(decision.photos) ? decision.photos : Object.values(decision.photos)) : [];

                        if (photosArray.length > 0) {
                            photosArray.forEach(photo => {
                                gallery.innerHTML += `<img src="${photo}" alt="Decision Gallery Photo">`;
                            });
                        } else {
                            gallery.innerHTML = '<p>‡§ï‡•ã‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>';
                        }
                    }
                },

                // --- 4. ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® ---
                navigate: {
                    showPage: function (pageId) {
                        app.currentPage = pageId;
                        app.elements.pages.forEach(page => page.classList.remove('active'));
                        document.getElementById(`page-${pageId}`).classList.add('active');

                        app.elements.navButtons.forEach(btn => {
                            const icon = btn.querySelector('.nav-indicator span');
                            const isActive = btn.dataset.page === pageId;
                            btn.classList.toggle('active', isActive);

                            if (isActive) {
                                icon.classList.remove('material-icons-outlined');
                                icon.classList.add('material-icons');
                            } else {
                                icon.classList.remove('material-icons');
                                icon.classList.add('material-icons-outlined');
                            }
                        });

                        const fab = app.elements.fab;
                        const fabIcon = app.elements.fabIcon;

                        switch (pageId) {
                            case 'home':
                                fab.classList.add('hidden');
                                break;
                            case 'meetings':
                                fab.classList.remove('hidden');
                                fabIcon.textContent = 'add';
                                break;
                            case 'members':
                                fab.classList.remove('hidden');
                                fabIcon.textContent = 'person_add';
                                break;
                            case 'decisions':
                                fab.classList.remove('hidden');
                                fabIcon.textContent = 'add_comment';
                                break;
                        }
                        window.scrollTo(0, 0);
                    }
                },

                // --- 5. ‡§Æ‡•ã‡§°‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§ø‡§Ç‡§ó ---
                modal: {
                    show: function (modalId) {
                        const modal = document.getElementById(`modal-${modalId}`);
                        if (modal) {
                            app.elements.modalBackdrop.classList.add('visible');
                            modal.classList.add('visible');
                        }
                    },
                    hide: function (modalId = null) {
                        if (modalId === 'image-viewer') {
                            app.elements.modalImageViewer.classList.remove('visible');
                            return;
                        }
                        app.elements.modalBackdrop.classList.remove('visible');
                        app.elements.allModals.forEach(modal => {
                            modal.classList.remove('visible');
                        });
                        app.elements.meetingForm.reset();
                        app.elements.memberForm.reset();
                        app.elements.decisionForm.reset();
                        app.elements.addPhotoForm.reset();
                        app.elements.addDecisionPhotoForm.reset();
                        app.elements.photoPreview.style.display = 'none';
                        app.elements.photoPreview.src = '';
                        app.elements.memberPhotoPreview.style.display = 'none';
                        app.elements.memberPhotoPreview.src = '';
                        app.elements.meetingForm.meetingPhoto.dataset.compressedData = '';
                        app.elements.memberForm.memberPhoto.dataset.compressedData = '';
                    }
                },

                // --- 6. ‡§ê‡§™ ‡§è‡§ï‡•ç‡§∂‡§®‡•ç‡§∏ (async, Base64 ‡§ï‡•á ‡§∏‡§æ‡§•) ---
                actions: {
                    handleFabClick: function () {
                        switch (app.currentPage) {
                            case 'meetings': app.modal.show('meeting'); break;
                            case 'members': app.modal.show('member'); break;
                            case 'decisions': app.modal.show('decision'); break;
                        }
                    },

                    submitMeeting: async function (e) {
                        e.preventDefault();
                        const form = app.elements.meetingForm;
                        const photoData = form.meetingPhoto.dataset.compressedData || 'https://placehold.co/600x400/eee/ccc?text=No+Photo';

                        const newMeeting = {
                            date: form.meetingDate.value,
                            agenda: form.meetingAgenda.value,
                            decisions: form.meetingDecisions.value,
                            photos: [photoData] // Base64 ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§ê‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                        };

                        app.toast.show('‡§¨‡•à‡§†‡§ï ‡§∏‡•á‡§µ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...');
                        try {
                            await dbFirebase.addMeeting(newMeeting);
                            app.modal.hide();
                            app.toast.show('‡§¨‡•à‡§†‡§ï ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∏‡•á‡§µ ‡§ï‡•Ä ‡§ó‡§à!');
                            app.navigate.showPage('meetings');
                        } catch (error) {
                            console.error("Error adding meeting:", error);
                            app.toast.show('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§¨‡•à‡§†‡§ï ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä‡•§', true);
                        }
                    },

                    submitMember: async function (e) {
                        e.preventDefault();
                        const form = app.elements.memberForm;
                        const photoData = form.memberPhoto.dataset.compressedData || null;

                        const newMember = {
                            name: form.memberName.value,
                            role: form.memberRole.value,
                            phone: form.memberPhone.value,
                            photo: photoData // Base64 ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó (‡§Ø‡§æ null) ‡§ï‡•ã ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                        };

                        app.toast.show('‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•á‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...');
                        try {
                            await dbFirebase.addMember(newMember);
                            app.modal.hide();
                            app.toast.show('‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ!');
                            app.navigate.showPage('members');
                        } catch (error) {
                            console.error("Error adding member:", error);
                            app.toast.show('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§', true);
                        }
                    },

                    submitDecision: async function (e) {
                        e.preventDefault();
                        const form = app.elements.decisionForm;
                        const newDecision = {
                            title: form.decisionTitle.value,
                            responsible: form.decisionResponsible.value,
                            status: form.decisionStatus.value,
                            details: form.decisionDetails.value,
                            photos: {}
                        };

                        app.toast.show('‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡•á‡§µ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...');
                        try {
                            await dbFirebase.addDecision(newDecision);
                            app.modal.hide();
                            app.toast.show('‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º‡§æ ‡§ó‡§Ø‡§æ!');
                            app.navigate.showPage('decisions');
                        } catch (error) {
                            console.error("Error adding decision:", error);
                            app.toast.show('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§', true);
                        }
                    },

                    submitAnotherPhoto: async function (e) {
                        e.preventDefault();
                        const form = app.elements.addPhotoForm;
                        const meetingId = form.elements['details-meeting-id'].value;
                        const photoFile = form.elements['newMeetingPhoto'].files[0];

                        if (photoFile) {
                            app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ï‡§Ç‡§™‡•ç‡§∞‡•á‡§∏ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...');
                            this.compressImage(photoFile, async (photoData) => {
                                app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•á‡§µ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...');
                                try {
                                    // Base64 ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§∏‡•Ä‡§ß‡•á ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç
                                    await dbFirebase.addPhotoToMeeting(meetingId, photoData);
                                    form.reset();
                                    app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à!');
                                } catch (error) {
                                    app.toast.show('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä‡•§', true);
                                }
                            });
                        } else {
                            app.toast.show('‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§', true);
                        }
                    },

                    submitAnotherPhotoToDecision: async function (e) {
                        e.preventDefault();
                        const form = app.elements.addDecisionPhotoForm;
                        const decisionId = form.elements['details-decision-id'].value;
                        const photoFile = form.elements['newDecisionPhoto'].files[0];

                        if (photoFile) {
                            app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ï‡§Ç‡§™‡•ç‡§∞‡•á‡§∏ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...');
                            this.compressImage(photoFile, async (photoData) => {
                                app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•á‡§µ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...');
                                try {
                                    await dbFirebase.addPhotoToDecision(decisionId, photoData);
                                    form.reset();
                                    app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡•ã‡§°‡§º‡•Ä ‡§ó‡§à!');
                                } catch (error) {
                                    app.toast.show('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä‡•§', true);
                                }
                            });
                        } else {
                            app.toast.show('‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ï ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§', true);
                        }
                    },

                    updateDecisionStatus: async function (id, newStatus, selectElement) {
                        selectElement.className = 'status-select status-' + newStatus;
                        try {
                            await dbFirebase.updateDecisionStatus(id, newStatus);
                            app.toast.show('‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ!');
                        } catch (error) {
                            console.error("Error updating status:", error);
                            app.toast.show('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ ‡§Ö‡§™‡§°‡•á‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ‡•§', true);
                        }
                    },

                    previewPhoto: function (event, previewElement, inputElement) {
                        const file = event.target.files[0];
                        if (!file) {
                            inputElement.dataset.compressedData = '';
                            previewElement.style.display = 'none';
                            return;
                        }

                        previewElement.src = URL.createObjectURL(file);
                        previewElement.style.display = 'block';

                        app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§ï‡§Ç‡§™‡•ç‡§∞‡•á‡§∏ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...');
                        this.compressImage(file, (compressedData) => {
                            inputElement.dataset.compressedData = compressedData;
                            app.toast.show('‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§∏‡•á‡§µ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à!');
                        }, (error) => {
                            app.toast.show(error, true);
                        });
                    },

                    compressImage: function (file, callback, errorCallback) {
                        const MAX_WIDTH = 1024;
                        const MAX_HEIGHT = 1024;
                        const MIME_TYPE = "image/jpeg";
                        const QUALITY = 0.7;

                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = new Image();
                            img.onload = () => {
                                let width = img.width;
                                let height = img.height;

                                if (width > height) {
                                    if (width > MAX_WIDTH) {
                                        height *= MAX_WIDTH / width;
                                        width = MAX_WIDTH;
                                    }
                                } else {
                                    if (height > MAX_HEIGHT) {
                                        width *= MAX_HEIGHT / height;
                                        height = MAX_HEIGHT;
                                    }
                                }

                                const canvas = document.createElement('canvas');
                                canvas.width = width;
                                canvas.height = height;
                                const ctx = canvas.getContext('2d');
                                ctx.drawImage(img, 0, 0, width, height);
                                const compressedData = canvas.toDataURL(MIME_TYPE, QUALITY);

                                // RTDB ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö (10MB~ ‡§∏‡•Ä‡§Æ‡§æ, ‡§≤‡•á‡§ï‡§ø‡§® ‡§π‡§Æ 5MB ‡§™‡§∞ ‡§∞‡•ã‡§ï‡•á‡§Ç‡§ó‡•á)
                                if (compressedData.length > 5 * 1024 * 1024) {
                                    if (errorCallback) errorCallback('Error: Image too large to save in database.');
                                    return;
                                }

                                callback(compressedData);
                            };
                            img.onerror = () => { if (errorCallback) errorCallback('Error: Invalid image file.'); };
                            img.src = e.target.result;
                        };
                        reader.onerror = () => { if (errorCallback) errorCallback('Error: Could not read image file.'); };
                        reader.readAsDataURL(file);
                    },

                    showMeetingDetails: function (id) {
                        const meeting = dbFirebase.getMeetingById(id);
                        if (meeting) {
                            app.render.meetingDetails(meeting);
                            app.modal.show('meeting-details');
                        }
                    },

                    showDecisionDetails: function (id) {
                        const decision = dbFirebase.getDecisionById(id);
                        if (decision) {
                            app.render.decisionDetails(decision);
                            app.modal.show('decision-details');
                        }
                    },

                    showFullscreenImage: function (src) {
                        app.elements.fullscreenImage.src = src;
                        app.modal.show('image-viewer');
                    },

                    shareText: function (id, type) {
                        let text = '*JAS Mitra Report*\n\n';
                        if (type === 'meeting') {
                            const meeting = dbFirebase.getMeetingById(id);
                            if (!meeting) return;
                            const photosArray = meeting.photos ? (Array.isArray(meeting.photos) ? meeting.photos : Object.values(meeting.photos)) : [];
                            text += `*Meeting Agenda:* ${meeting.agenda}\n`;
                            text += `*Date:* ${meeting.date}\n`;
                            text += `*Decisions:* ${meeting.decisions || 'N/A'}\n`;
                            text += `\n*${photosArray.length} photo(s) available in the app.*`;
                        } else {
                            const decision = dbFirebase.getDecisionById(id);
                            if (!decision) return;
                            const photosArray = decision.photos ? (Array.isArray(decision.photos) ? decision.photos : Object.values(decision.photos)) : [];
                            text += `*Decision:* ${decision.title}\n`;
                            text += `*Status:* ${decision.status}\n`;
                            text += `*Responsible:* ${decision.responsible}\n`;
                            text += `*Notes:* ${decision.details || 'N/A'}\n`;
                            text += `\n*${photosArray.length} photo(s) available in the app.*`;
                        }
                        const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
                        window.open(url, '_blank');
                    },

                    generatePdf: async function (id, type) {
                        app.toast.show('Generating PDF...');
                        const doc = new jsPDF({ unit: 'pt', format: 'a4' });
                        const renderContainer = document.getElementById('pdf-render-container');
                        let reportHtml = '';
                        let fileName = 'JAS_Mitra_Report.pdf';

                        if (type === 'meeting') {
                            const meeting = dbFirebase.getMeetingById(id);
                            if (!meeting) return;
                            fileName = `JAS_Mitra_Meeting_${meeting.id}.pdf`;
                            const photosArray = meeting.photos ? (Array.isArray(meeting.photos) ? meeting.photos : Object.values(meeting.photos)) : [];

                            reportHtml = `
                                <h1 style="font-size: 18pt; color: #2A9D8F; font-weight: bold;">JAS Mitra Report</h1>
                                <h2 style="font-size: 14pt; font-weight: bold; margin-top: 15px;">‡§¨‡•à‡§†‡§ï: ${meeting.agenda}</h2>
                                <p style="font-size: 10pt; margin-top: 10px;"><b>‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï:</b> ${meeting.date}</p>
                                <h3 style="font-size: 12pt; font-weight: bold; margin-top: 15px;">‡§≤‡§ø‡§è ‡§ó‡§è ‡§®‡§ø‡§∞‡•ç‡§£‡§Ø:</h3>
                                <p style="font-size: 10pt; white-space: pre-wrap; word-wrap: break-word;">${meeting.decisions || 'N/A'}</p>
                                <h3 style="font-size: 12pt; font-weight: bold; margin-top: 15px;">‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞‡•á‡§Ç:</h3>
                            `;
                            if (photosArray.length > 0) {
                                photosArray.forEach(photo => {
                                    reportHtml += `<img src="${photo}" style="width: 100%; max-width: 550px; margin-top: 10px; border: 1px solid #eee; break-inside: avoid;">`;
                                });
                            } else {
                                reportHtml += '<p style="font-size: 10pt;">‡§ï‡•ã‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>';
                            }

                        } else {
                            const decision = dbFirebase.getDecisionById(id);
                            if (!decision) return;
                            fileName = `JAS_Mitra_Decision_${decision.id}.pdf`;
                            const photosArray = decision.photos ? (Array.isArray(decision.photos) ? decision.photos : Object.values(decision.photos)) : [];

                            reportHtml = `
                                <h1 style="font-size: 18pt; color: #2A9D8F; font-weight: bold;">JAS Mitra Report</h1>
                                <h2 style="font-size: 14pt; font-weight: bold; margin-top: 15px;">‡§®‡§ø‡§∞‡•ç‡§£‡§Ø: ${decision.title}</h2>
                                <p style="font-size: 10pt; margin-top: 10px;"><b>‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞:</b> ${decision.responsible}</p>
                                <p style="font-size: 10pt; margin-top: 5px;"><b>‡§∏‡•ç‡§•‡§ø‡§§‡§ø:</b> ${decision.status}</p>
                                <h3 style="font-size: 12pt; font-weight: bold; margin-top: 15px;">‡§µ‡§ø‡§µ‡§∞‡§£ / ‡§®‡•ã‡§ü‡•ç‡§∏:</h3>
                                <p style="font-size: 10pt; white-space: pre-wrap; word-wrap: break-word;">${decision.details || 'N/A'}</p>
                                <h3 style="font-size: 12pt; font-weight: bold; margin-top: 15px;">‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞‡•á‡§Ç:</h3>
                            `;
                            if (photosArray.length > 0) {
                                photosArray.forEach(photo => {
                                    reportHtml += `<img src="${photo}" style="width: 100%; max-width: 550px; margin-top: 10px; border: 1px solid #eee; break-inside: avoid;">`;
                                });
                            } else {
                                reportHtml += '<p style="font-size: 10pt;">‡§ï‡•ã‡§à ‡§§‡§∏‡•ç‡§µ‡•Ä‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§</p>';
                            }
                        }

                        renderContainer.innerHTML = reportHtml;

                        try {
                            const canvas = await html2canvas(renderContainer, {
                                scale: 2,
                                useCORS: false // Base64 ‡§ï‡•á ‡§≤‡§ø‡§è 'false' ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                            });

                            const imgData = canvas.toDataURL('image/png');
                            const imgProps = doc.getImageProperties(imgData);
                            const pdfWidth = doc.internal.pageSize.getWidth();
                            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
                            let heightLeft = pdfHeight;
                            let position = 0;
                            const pageHeight = doc.internal.pageSize.getHeight();

                            doc.addImage(imgData, 'PNG', 0, position, pdfWidth, pdfHeight);
                            heightLeft -= pageHeight;

                            while (heightLeft > 0) {
                                position = -heightLeft;
                                doc.addPage();
                                doc.addImage(imgData, 'PNG', 0, position, pdfWidth, pdfHeight);
                                heightLeft -= pageHeight;
                            }
                            doc.save(fileName);
                            app.toast.show('PDF Downloaded!');
                        } catch (e) {
                            console.error("Error generating PDF:", e);
                            app.toast.show('Error generating PDF. Check console.', true);
                        }
                        renderContainer.innerHTML = '';
                    }
                },

                // --- 7. ‡§ü‡•ã‡§∏‡•ç‡§ü ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ---
                toast: {
                    show: function (message, isError = false) {
                        const toast = document.createElement('div');
                        toast.className = 'toast';
                        toast.textContent = message;
                        if (isError) {
                            toast.classList.add('error');
                        }
                        document.getElementById('toast-container').appendChild(toast);
                        setTimeout(() => toast.classList.add('show'), 10);
                        setTimeout(() => {
                            toast.classList.remove('show');
                            setTimeout(() => toast.remove(), 300);
                        }, 3000);
                    }
                }
            };

            // --- ‡§ê‡§™ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç ---
            app.init();
        });
    </script>
</body>

</html>
